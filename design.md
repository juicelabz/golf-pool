This design document is structured specifically for an AI coding agent to ingest as a "Source of Truth" for building the **Fantasy Golf Pool Invitational (2026)** application.

---

# â›³ PROJECT SPECIFICATION: The YTOWN Invitational 2026

## 1. Executive Summary

A local-first, read-optimized web application for a private 108-member fantasy golf league. The app replaces a legacy Excel system to provide a live-updating leaderboard, member roster tracking, and segment-based scoring.

* **Primary Users:** 108 League Members (Read-only).
* **Admins:** James Mack (Commissioner - Payments/Rosters), Dan Culp (Data Man - Scoring/Imports).
* **Key Constraint:** Minimal cost. Local-first architecture (SQLite/ElectricSQL) to avoid expensive hosting/API fees.

## 2. Technical Stack

* **Runtime:** Bun
* **Language:** TypeScript
* **Framework:** TanStack Start (File-based routing, Server Functions).
* **UI:** shadcn/ui + Tailwind CSS.
* **Database (Server):** `bun:sqlite` with Drizzle ORM.
* **Database (Client):** TanStack DB + ElectricSQL (for real-time leaderboard sync).
* **Auth:** Better-Auth (with `admin` plugin for Commissioner and Data man).

## 3. Core Data Schema

### `users` (generated by better-auth)

* `id`: UUID
* `email`: string (unique)
* `firstName`: string
* `lastName`: string
* `role`: enum ('admin', 'data', 'user')
* `isPaid`: boolean (default: false)

### `golfers` (The 119 golfers from [Chalk Counter](/data/chalk-counter.csv))

* `id`: string (PGA ID or slug)
* `name`: string
* `category`: integer (1-7, or 8 for open picks)
* `isEligible`: boolean (Scottie Scheffler = false)

### `members` (The 108 participants)

* `id`: UUID
* `name`: string (e.g., "John Smith")
* `roster`: Relation to `golfers` (10 players per member)

### `tournaments`

* `id`: integer
* `name`: string
* `type`: enum ('Standard', 'Double', 'Triple')
* `segment`: integer (1-5)
* `startDate`: date
* `endDate`: date

### `scoring` (Weekly Results)

* `tournamentId`: reference
* `golferId`: reference
* `rank`: integer
* `points`: integer (Calculated based on `tournament.type` and `rank`)

---

## 4. Scoring Logic & Rules

The app must implement the following point mapping for **Top 10** finishes (including ties):

| Rank | Standard | Double | Triple |
| --- | --- | --- | --- |
| 1st | 15 | 30 | 45 |
| 2nd | 10 | 20 | 30 |
| 3rd | 8 | 16 | 24 |
| 4th | 7 | 14 | 21 |
| 5th | 6 | 12 | 18 |
| 6th | 5 | 10 | 15 |
| 7th | 4 | 8 | 12 |
| 8th | 3 | 6 | 9 |
| 9th | 2 | 4 | 6 |
| 10th | 1 | 2 | 3 |

*Source:*

---

## 5. Feature Requirements

### R1: The Live Leaderboard

* Default view: Cumulative season points.
* Toggle views: Segment 1, Segment 2, etc..
* Reactivity: Uses **TanStack DB** to update rankings immediately when new data is pushed to the SQLite file.

### R2: Admin Dashboard

* **Payment Tracking:** James Mack can toggle `isPaid` for members.
* **Roster Management:** Fix incorrect picks or handle the 108 vs 109 member discrepancy during initial import.
* **Data Import:** Dan Culp can upload a CSV of weekly ranks to populate the `scoring` table.

### R3: The Scraper (Internal Worker)

A lightweight Bun script to fetch live ranks during tournament hours.

```typescript
// sample-scraper.ts (Bun-native)
import { load } from "cheerio";

async function scrapePGA() {
  const response = await fetch("https://www.pgatour.com/leaderboard");
  const html = await response.text();
  const $ = load(html);

  const results: { name: string; rank: number }[] = [];
  
  // Example selector: logic must target the specific leaderboard table rows
  $(".leaderboard-row").each((i, el) => {
    const name = $(el).find(".player-name").text().trim();
    const rankText = $(el).find(".player-rank").text().trim();
    const rank = parseInt(rankText.replace('T', ''));
    
    if (rank <= 10) {
      results.push({ name, rank });
    }
  });

  return results;
}

```

---

## 6. Implementation Plan for AI Agent

1. **Step 1 (Auth):** Initialize Bun project and set up `better-auth` with `bun:sqlite` adapter. Configure `admin` and `data`, and `user` roles.
2. **Step 2 (Schema):** Generate Drizzle migrations for all tables listed in Section 3.
3. **Step 3 (Data Seeding):** Import the initial 108 members and 119 golfers from the provided Excel data.
4. **Step 4 (Logic):** Create a `calculatePoints` helper function implementing the Table in Section 4.
5. **Step 5 (UI):** Build the Main Leaderboard using `tanstack-table` for high performance.
6. **Step 6 (Sync):** Integrate ElectricSQL to bridge server-side SQLite updates to the client-side TanStack DB.

---

**Would you like me to generate the specific Drizzle schema file code to give your agent a head start?**